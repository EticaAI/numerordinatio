<!doctype html>
<html lang="la">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"
    referrerpolicy="no-referrer">
  <link rel="icon" href="img/favicon.png">
  <title>Numerordĭnātĭo pictūrae</title>
  <style>
    details>details {
      padding-left: 2em;
    }
  </style>
</head>

<body>
  <h1>Numerordĭnātĭo pictūrae</h1>

  <div id="picturam-notitia">
    <ul>
      <li>Exemplum: <a target="_blank" href='./picturam.html#?peritum={"json_iri":"data/exemplum/scientiae-communitatem--sexualitatem.json"}'>./picturam.html#?peritum={"json_iri":"data/exemplum/scientiae-communitatem--sexualitatem.json"}</a></li>
      <li>Exemplum: <a target="_blank" href='./picturam.html#?peritum={"json_data":{"10":{},"10:1":{"lat-Latn":{"0":"Exemplum"},"prs-Arab":{"0":"مثال"},"rus-Cyrl":{"0":"Пример"}}}}'>./picturam.html#?peritum={"json_data":{"10":{},"10:1":{"lat-Latn":{"0":"Exemplum"},"prs-Arab":{"0":"مثال"},"rus-Cyrl":{"0":"Пример"}}}}</a></li>
      <li>Exemplum: <a target="_blank" href='./picturam.html#?peritum={"json_form":{"10":{},"10:1":{"lat-Latn":{"0":"Exemplum"},"prs-Arab":{"0":"مثال"},"rus-Cyrl":{"0":"Пример"}}}}'>./picturam.html#?peritum={"json_form":{"10":{},"10:1":{"lat-Latn":{"0":"Exemplum"},"prs-Arab":{"0":"مثال"},"rus-Cyrl":{"0":"Пример"}}}}</a></li>
    </ul>
  </div>
  <div class="row">
    <div id="picturam-form" class="col" style="display: none">
      <textarea style="width: 100%; height: auto; min-height: 20em;" id="picturam-form-textarea"></textarea>
    </div>
    <div id="picturam-html" class="col">
    </div>
  </div>


  <div class="d3_svg_demo2"></div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
    integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"
    referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.2.1/d3.min.js"
    integrity="sha512-wkduu4oQG74ySorPiSRStC0Zl8rQfjr/Ty6dMvYTmjZw6RS5bferdx8TR7ynxeh79ySEp/benIFFisKofMjPbg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="module">
    import * as Picturam from './lib/numerordinatio-picturam.mjs';

    let peritum_defallo = {
      'json_iri': null,
      'data': null,
    }

    let pic_html = new Picturam.PicturamDL(d3, '#picturam-html')
    let pic_exemplum = document.getElementById('picturam-notitia')

    function render(data) {
      pic_exemplum.innerHTML = ''
      pic_html.estData(data)
      let crudum_html = pic_html.inHtml()
      let wp = document.getElementById('picturam-html')
      wp.innerHTML = crudum_html
    }

    // http://git.workspace.localhost/EticaAI/numerordinatio/docs/picturam.html#?peritum={"json_iri":"data/exemplum/scientiae-communitatem--sexualitatem.json"}
    function fontem_data_peritum(functionem_regressae){
      let resultatum = peritum_defallo
      // console.log('fontem_data_peritum...')
      if (document.location.hash.indexOf('#?peritum=') > -1) {
        let crudum = document.location.hash.replace('#?peritum=', '')
        let decodedURI = ''
        let decodecodedURIJSONdedURI = null
        // console.log(crudum, decodeURI(crudum))
        try {
          decodedURI = decodeURI(crudum).replace(/^\'+|\'+$/g, '')
          // console.log('decodedURI', decodedURI)
          decodecodedURIJSONdedURI = JSON.parse(decodedURI)
          // console.log('decodecodedURIJSONdedURI', decodecodedURIJSONdedURI)

          resultatum.json_iri = decodecodedURIJSONdedURI.json_iri || null
          resultatum.json_data = decodecodedURIJSONdedURI.json_data || null
          resultatum.json_form = decodecodedURIJSONdedURI.json_form || null

        } catch (error) {
          console.log('error resultatum', resultatum)
        }
        if (resultatum.json_iri){
          console.log('resultatum.json_iri', resultatum.json_iri)
          d3.json(resultatum.json_iri).then((data) => {
            render(data)
          })
        } else if (resultatum.json_data){
          console.log('resultatum.json_data', resultatum.json_data)
          render(resultatum.json_data)
        } else if (resultatum.json_form){
          console.log('resultatum.json_form', resultatum.json_form)
          document.getElementById('picturam-form').style.display = 'block'
          document.getElementById('picturam-form-textarea').value = JSON.stringify(resultatum.json_form, null, 2)
          document.getElementById('picturam-form-textarea').addEventListener('change', function(el){
            render(resultatum.json_form)
          })
          // $('#picturam-form').toggle()
          render(resultatum.json_form)
        } else {
          console.log('no json_iri', resultatum)
        }
      }
      console.log(resultatum)
    }

    // function fontem_data(functionem_regressae) {
    //   let _functionem_regressae = functionem_regressae || console.log
    //   let de_hash = {}
    //   let _hash = document.location.hash
    //   if (_hash.indexOf('#?json_iri=') > -1) {
    //     let json_iri = _hash.replace('#?json_iri=', '')

    //     d3.json(json_iri).then((data) => {
    //       functionem_regressae(data)
    //     });
    //   }
    //   functionem_regressae(de_hash)
    // }

    fontem_data_peritum()
    // fontem_data(function (data) {
    //   render(data)
    // })


    // d3.json("data/exemplum/scientiae-communitatem--sexualitatem.json").then((data) => {
    //   render(data)
    // });
  </script>
</body>

</html>
